PRD.md - Product Requirements DocumentModule: Financial Health & Profitability Control (BI Extension)Target Date: Mid-June 20261. Context & GoalAppix needs to transform its Dashboard from a task tracker to a financial command center. The goal is to cross-reference Budget (Estimates), Technical Progress (Jira), and Resource Consumption (Clockify) to predict profitability risks in real-time.2. Core Concept: The Triple Axis VarianzaThe system must calculate and visualize the relationship between:Estimated: Total budgeted hours/cost per phase.Real Consumption: Actual hours logged via Clockify.Real Progress: Completion % derived from Jira Story Points or Task counts.Logic for Alarms:CRITICAL: Consumption >= 80% AND Progress < 50%.WARNING: Deviation between Consumption % and Progress % > 15%.HEALTHY: Deviation <= 10%.3. User StoriesEpica 1: Data Integration (Backend)US-01: As a System, I need to sync with Clockify API every hour to fetch time entries by Project and Tag (mapping Tags to "Phases").US-02: As a System, I need to match Jira Projects to Clockify Projects via a dedicated ID field or Fuzzy Matching.US-03: As a PM, I want to define Hourly Rates (Cost) per Role (e.g., "Backend Dev": $70/hr) globally and per project.Epica 2: Visualization (Frontend)US-04: As a PM, I want to see a "Financial Burndown" chart comparing Budget Line vs. Actual Cost vs. Earned Value.US-05: As a Director, I want a Portfolio List view with "Traffic Light" indicators (Red/Yellow/Green) based on the Alert Logic.US-06: As a PM, I want to see a Bar Chart comparing Estimated vs. Actual hours broken down by Phase (Planning, Design, Dev, QA).Epica 3: Reporting & AlertsUS-07: As a PM, I want to receive an immediate in-app notification if a project enters "Critical" status.US-08: As a User, I want to export a PDF Report containing the Executive Summary and Variance Graphs.4. Data Model (Key Entities)Ref: Based on SQL provided in requirements.Projects: Added fields: budget_hours, client_invoice_amount, target_margin.Integrations: jira_project_key, clockify_project_id.BillingRoles: role_name, default_hourly_rate.TimeEntries: Synced from Clockify, tagged with Phase.HealthSnapshots: Historical record of the Triple Axis metrics for trend analysis.5. Criterios de AceptaciÃ³n (Gherkin)Scenario: Critical Alert GenerationGIVEN a project "E-commerce Redesign" with Budget: 100 hours
AND the Clockify Sync reports 85 hours consumed (85%)
AND the Jira Sync reports 40% completion
WHEN the Health Evaluation Service runs
THEN the Project Status must update to "CRITICAL"
AND a `ProjectHealthAlert` record is created
AND the Dashboard displays a "Critical Deviation" banner.
